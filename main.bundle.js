(()=>{"use strict";const e={element:document.querySelector("#game-board"),height:400,width:900},t={height:400,width:200,lives:null,elements:{container:document.getElementById("castle"),livesText:document.getElementById("castle-lives")},game:void 0,setup(e,t){this.game=e,this.lives=t,this.draw()},damage(e){this.lives-=e,this.draw(),0===this.lives&&this.game.gameOver()},draw(){this.elements.livesText.textContent=Math.max(0,this.lives)}},s=function(e,t,{autoRestart:s=!0}={}){let n=e;return Object.freeze({tick:function(i){n=Math.max(0,n-i),n<=1&&(t(),s&&(n=e))},getHumanTimeRemaining:function(){const e=Math.ceil(n/1e3)%60,t=Math.floor(Math.ceil(n/1e3)/60);return`${t<10?`0${t}`:t}:${e<10?`0${e}`:e}`}})},n={easy:["+","-"],medium:["+","-","×"],hard:["+","-","×"],insane:["+","-","×","÷"]},i=e=>Math.floor(Math.random()*e),a=e=>i((e=>{switch(e){case"easy":return 5;case"medium":return 10;case"hard":return 30;case"insane":return 100;default:return 5}})(e))+1,r=e=>{const t=(e=>n[e][(e=>i(n[e].length))(e)])(e);let s=a(e),r=a(e);for(;"÷"===t&&s%r!=0;)s=a(e),r=a(e);for(;"-"===t&&s-r<0;)s=a(e),r=a(e);for(;"×"===t&&s*r>150;)s=a(e),r=a(e);for(;"+"===t&&s+r>150;)s=a(e),r=a(e);const m=`${s} ${t} ${r}`;return{text:m,answer:(e=>{const t=e.split(" "),s=Number(t[0]),n=t[1],i=Number(t[2]);let a;return a="+"===n?s+i:"-"===n?s-i:"×"===n?s*i:s/i,a})(m)}},m=document.querySelectorAll("[data-score-display]");let h=0;function l(){m.forEach((e=>{e.textContent=`Score: ${h}`}))}const c=Object.freeze({addPoints:function(e){e<0?h=Math.max(0,h+e):h+=e,l()},reset:function(){h=0,l()}}),o={firstLane:50,secondLane:165,thirdLane:280};let d=40;const u=document.getElementById("start-page"),g=document.getElementById("game-page"),y=document.getElementById("game-over-page"),w=new class{constructor(){this.gameBoard=e,this.castle=t,this.answerForm=document.querySelector(".answer-form"),this.answerInput=document.querySelector("#answer-input"),this.gameTimer=document.querySelector("#game-timer"),this.wrongAnswersEl=document.querySelector("#game-over-wrong-answers"),this.fieldWidth=e.width-t.width,this.enemies=[],this.selectedEnemy=null,this.timers={},this.gameState=0,this.wrongAnswers=0,this.update=this.update.bind(this),this.draw=this.draw.bind(this),this.spawnEnemy=this.spawnEnemy.bind(this),this.handleAnswerSubmit=this.handleAnswerSubmit.bind(this),this.gameOver=this.gameOver.bind(this),this.handleSelectEnemy=this.handleSelectEnemy.bind(this)}start(){c.reset(),this.wrongAnswers=0,this.castle.setup(this,3),this.answerForm.addEventListener("submit",this.handleAnswerSubmit),this.gameState=1,this.initialiseTimers(),u.style.display="none",y.style.display="none",g.style.display="flex"}pause(){this.gameState=3,this.enemies.forEach((e=>e.elements.enemy.classList.add("not-clickable")))}continue(){this.gameState=1,this.enemies.forEach((e=>e.elements.enemy.classList.remove("not-clickable")))}update(e){1===this.gameState&&(Object.keys(this.timers).forEach((t=>this.timers[t].tick(e))),this.enemies.forEach((t=>t.update(e))))}draw(){this.gameTimer.textContent=this.timers.countDownTimer.getHumanTimeRemaining(),this.enemies.forEach((e=>e.draw()))}spawnEnemy(){const e=function({position:{x:e,y:t},speed:s,question:n,game:i}={}){const a={x:e,y:t},r=function(){const e=document.createElement("div"),t=document.createElement("div");return e.classList.add("enemy"),e.style.width="50px",e.style.height="50px",t.classList.add("enemy-question"),t.textContent=n.text,e.appendChild(t),e.addEventListener("click",i.handleSelectEnemy),e}();function m(){i.deleteEnemy(r),r.remove()}return Object.freeze({update:function(e){if(a.x>=i.fieldWidth-50)return m(),void i.damageCastle(1);a.x+=s*(e/1e3)},draw:function(){r.style.transform=`translate(${a.x}px, ${a.y}px)`},handleDelete:m,toggleSelect:function(){r.classList.toggle("selected")},question:n,get element(){return r}})}({position:{x:0,y:this.randomLane()},speed:d,question:r("insane"),game:this});d+=3,this.gameBoard.element.appendChild(e.element),this.enemies.push(e)}randomLane(){const e=Object.keys(o);return o[e[Math.floor(Math.random()*e.length)]]}deleteEnemy(e){this.enemies=this.enemies.filter((t=>t.element!==e||(this.selectedEnemy===t&&(this.selectedEnemy=null),!1)))}gameOver(){this.gameState=2,this.wrongAnswersEl.textContent=`Wrong Answers: ${this.wrongAnswers}`,g.style.display="none",y.style.display="flex",this.enemies.forEach((e=>{e.handleDelete()})),this.answerInput.value="",d=40}initialiseTimers(){this.timers.spawnTimer=s(2500,this.spawnEnemy),this.timers.countDownTimer=s(3e5,this.gameOver,{autoRestart:!1})}handleAnswerSubmit(e){if(e.preventDefault(),!this.selectedEnemy||""===this.answerInput.value.trim())return;const t=this.selectedEnemy.question.answer.toString();this.answerInput.value===t?(this.selectedEnemy.handleDelete(),this.selectedEnemy=null,c.addPoints(10)):(c.addPoints(-2),this.wrongAnswers+=1),this.answerInput.value=""}handleSelectEnemy(e){this.answerInput.focus();const t=this.enemies.find((t=>t.element===e.currentTarget));t!==this.selectedEnemy&&(this.selectedEnemy&&this.selectedEnemy.toggleSelect(),t.toggleSelect(),this.selectedEnemy=t)}damageCastle(e){c.addPoints(-10),this.castle.damage(e)}},p=new class{constructor(e,t){this.running=!1,this.rafID=void 0,this.update=e,this.draw=t,this.accumulatedTime=0,this.currentTime=0,this.timeStep=1e3/60,this.cycle=this.cycle.bind(this)}cycle(e){this.rafID=requestAnimationFrame(this.cycle),this.accumulatedTime+=e-this.currentTime,this.currentTime=e;let t=!1;for(this.accumulatedTime>60&&(this.accumulatedTime=this.timeStep);this.accumulatedTime>=this.timeStep;)this.update(this.timeStep),t=!0,this.accumulatedTime-=this.timeStep;t&&this.draw()}start(){this.running=!0,this.rafID=requestAnimationFrame(this.cycle)}stop(){this.running=!1,cancelAnimationFrame(this.rafID)}}(w.update,w.draw),f=document.querySelector(".start-button"),E=document.querySelector(".restart-button"),S=document.querySelector(".pause-button");function v(){p.start(),w.start()}f.addEventListener("click",v),E.addEventListener("click",v),S.addEventListener("click",(function(){const[e,t]=["Continue","Pause"];1===w.gameState?(w.pause(),p.stop(),S.textContent=e):3===w.gameState&&(p.start(),w.continue(),S.textContent=t)}))})();
//# sourceMappingURL=main.bundle.js.map