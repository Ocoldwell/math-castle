(()=>{"use strict";const e={element:document.querySelector("#game-board"),height:400,width:1e3},t={height:400,width:137,lives:null,elements:{container:document.getElementById("castle"),livesText:document.getElementById("castle-lives")},setup(e){this.lives=e,this.draw()},damage(e,t){this.lives-=e,this.draw(),0===this.lives&&t()},draw(){this.elements.livesText.textContent=Math.max(0,this.lives)}},n=function(e,t,{autoRestart:n=!0}={}){let i=e;return Object.freeze({tick:function(c){i=Math.max(0,i-c),i<=1&&(t(),n&&(i=e))},getHumanTimeRemaining:function(){const e=Math.ceil(i/1e3)%60,t=Math.floor(Math.ceil(i/1e3)/60);return`${t<10?`0${t}`:t}:${e<10?`0${e}`:e}`}})},i={easy:["+","-"],medium:["+","-","×"],hard:["+","-","×"],insane:["+","-","×","÷"]},c=e=>Math.floor(Math.random()*e),s=e=>c((e=>{switch(e){case"easy":return 5;case"medium":return 10;case"hard":return 30;case"insane":return 100;default:return 5}})(e))+1,a=e=>{const t=(e=>i[e][(e=>c(i[e].length))(e)])(e);let n=s(e),a=s(e);for(;"÷"===t&&n%a!=0;)n=s(e),a=s(e);for(;"-"===t&&n-a<0;)n=s(e),a=s(e);for(;"×"===t&&n*a>150;)n=s(e),a=s(e);for(;"+"===t&&n+a>150;)n=s(e),a=s(e);const r=`${n} ${t} ${a}`;return{text:r,answer:(e=>{const t=e.split(" "),n=Number(t[0]),i=t[1],c=Number(t[2]);let s;return s="+"===i?n+c:"-"===i?n-c:"×"===i?n*c:n/c,s})(r)}},r=document.querySelectorAll("[data-score-display]");let o=0;function u(){r.forEach((e=>{e.textContent=o}))}const l=Object.freeze({addPoints:function(e){e<0?o=Math.max(0,o+e):o+=e,u()},reset:function(){o=0,u()}}),d={SPAWN_POINTS:{FIRST_LANE:{x:0,y:50},SECOND_LANE:{x:0,y:165},THIRD_LANE:{x:0,y:280}},POINTS:{CORRECT_ANSWER:10,WRONG_ANSWER:-2,CASTLE_LIFE_LOST:-10},enemySpeed:30,enemySpeedIncrement:3,spawnTimerMs:2700,gameTimerMs:3e5,questionDifficulty:"medium",castleStartingLives:3};function m(e){e.style.display="none"}function f(e,t){e.style.display=t}const h=document.querySelector("#start-page"),y=document.querySelector("#game-page"),S=document.querySelector("#game-over-page"),p=document.querySelector("#difficulty-select-page"),g=document.querySelector(".answer-form"),E=document.querySelector("#answer-input"),T=document.querySelector("#game-timer"),x=document.querySelector("#game-over-wrong-answers"),v=document.querySelector(".start-button"),q=document.querySelector("#restart-button"),w=document.querySelector(".pause-button"),L=document.querySelectorAll("[data-difficulty"),N=document.querySelector("#home-button"),O={...d},C={},I=e.width-(t.width-70),b=new class{constructor(e,t){this.running=!1,this.rafID=void 0,this.update=e,this.draw=t,this.accumulatedTime=0,this.currentTime=0,this.timeStep=1e3/60,this.cycle=this.cycle.bind(this)}cycle(e){this.rafID=requestAnimationFrame(this.cycle),this.accumulatedTime+=e-this.currentTime,this.currentTime=e;let t=!1;for(this.accumulatedTime>60&&(this.accumulatedTime=this.timeStep);this.accumulatedTime>=this.timeStep;)this.update(this.timeStep),t=!0,this.accumulatedTime-=this.timeStep;t&&this.draw()}start(){this.running=!0,this.rafID=requestAnimationFrame(this.cycle)}stop(){this.running=!1,cancelAnimationFrame(this.rafID)}}((function(e){1===A&&(Object.keys(C).forEach((t=>C[t].tick(e))),M.forEach((t=>t.update(e))))}),(function(){T.textContent=C.gameTimer.getHumanTimeRemaining(),M.forEach((e=>e.draw()))}));let A=0,R=null,P=0,M=[];function _(){const t=function({position:{x:e,y:t},speed:n,question:i,fieldWidth:c,handleSelectEnemy:s,damageCastle:a,deleteEnemy:r}={}){const o={x:e,y:t},u=function(){const e=document.createElement("div"),t=document.createElement("div");return e.classList.add("enemy"),e.style.width="50px",e.style.height="50px",t.classList.add("enemy-question"),t.textContent=i.text,e.appendChild(t),e.addEventListener("click",s),e}();function l(){r(u),u.remove()}return Object.freeze({update:function(e){if(o.x>=c-50)return l(),void a(1);o.x+=n*(e/1e3)},draw:function(){u.style.transform=`translate(${o.x}px, ${o.y}px)`},handleDelete:l,toggleSelect:function(){u.classList.toggle("selected")},question:i,get element(){return u}})}({position:D(),speed:O.enemySpeed,question:a(O.questionDifficulty),fieldWidth:I,handleSelectEnemy:$,damageCastle:j,deleteEnemy:k});O.enemySpeed+=O.enemySpeedIncrement,e.element.appendChild(t.element),M.push(t)}function D(){const e=Object.keys(O.SPAWN_POINTS);return O.SPAWN_POINTS[e[Math.floor(Math.random()*e.length)]]}function k(e){M=M.filter((t=>t.element!==e||(R===t&&(R=null),!1)))}function W(e){if(e.preventDefault(),!R||""===E.value.trim())return;const t=R.question.answer.toString();E.value===t?(R.handleDelete(),R=null,l.addPoints(O.POINTS.CORRECT_ANSWER)):(l.addPoints(O.POINTS.WRONG_ANSWER),P+=1),E.value=""}function $(e){E.focus();const t=M.find((t=>t.element===e.currentTarget));t!==R&&(R&&R.toggleSelect(),t.toggleSelect(),R=t)}function j(e){l.addPoints(O.POINTS.CASTLE_LIFE_LOST),t.damage(e,F)}function F(){A=2,x.textContent=P,m(y),f(S,"flex")}function z(){O.enemySpeed=d.enemySpeed,C.spawnTimer=n(O.spawnTimerMs,_),C.gameTimer=n(O.gameTimerMs,F,{autoRestart:!1}),l.reset(),P=0,E.value="",t.setup(O.castleStartingLives),M.forEach((e=>e.handleDelete()))}function H(){z(),m(S),f(y,"flex"),A=1}function B(){const[e,t]=["Continue","Pause"];1===A?(A=3,M.forEach((e=>e.element.classList.add("not-clickable"))),b.stop(),w.textContent=e):3===A&&(b.start(),A=1,M.forEach((e=>e.element.classList.remove("not-clickable"))),w.textContent=t)}function G(){m(h),f(p,"flex")}function J(e){const t=e.target.dataset.difficulty;m(p),f(y,"flex"),function(e){z(),O.questionDifficulty=e,A=1,b.start()}(t)}function K(){b.stop(),A=0,m(y),f(p,"flex")}Object.freeze({init:function(){v.addEventListener("click",G),q.addEventListener("click",H),w.addEventListener("click",B),g.addEventListener("submit",W),L.forEach((e=>e.addEventListener("click",J))),N.addEventListener("click",K)}}).init()})();
//# sourceMappingURL=main.bundle.js.map