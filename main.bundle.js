(()=>{"use strict";const e={element:document.querySelector("#game-board"),height:400,width:900},t={height:400,width:200,lives:null,elements:{container:document.getElementById("castle"),livesText:document.getElementById("castle-lives")},setup(e){this.lives=e,this.draw()},damage(e,t){this.lives-=e,this.draw(),0===this.lives&&t()},draw(){this.elements.livesText.textContent=Math.max(0,this.lives)}},n=function(e,t,{autoRestart:n=!0}={}){let i=e;return Object.freeze({tick:function(a){i=Math.max(0,i-a),i<=1&&(t(),n&&(i=e))},getHumanTimeRemaining:function(){const e=Math.ceil(i/1e3)%60,t=Math.floor(Math.ceil(i/1e3)/60);return`${t<10?`0${t}`:t}:${e<10?`0${e}`:e}`}})},i={easy:["+","-"],medium:["+","-","×"],hard:["+","-","×"],insane:["+","-","×","÷"]},a=e=>Math.floor(Math.random()*e),s=e=>a((e=>{switch(e){case"easy":return 5;case"medium":return 10;case"hard":return 30;case"insane":return 100;default:return 5}})(e))+1,r=e=>{const t=(e=>i[e][(e=>a(i[e].length))(e)])(e);let n=s(e),r=s(e);for(;"÷"===t&&n%r!=0;)n=s(e),r=s(e);for(;"-"===t&&n-r<0;)n=s(e),r=s(e);for(;"×"===t&&n*r>150;)n=s(e),r=s(e);for(;"+"===t&&n+r>150;)n=s(e),r=s(e);const c=`${n} ${t} ${r}`;return{text:c,answer:(e=>{const t=e.split(" "),n=Number(t[0]),i=t[1],a=Number(t[2]);let s;return s="+"===i?n+a:"-"===i?n-a:"×"===i?n*a:n/a,s})(c)}},c=document.querySelectorAll("[data-score-display]");let o=0;function u(){c.forEach((e=>{e.textContent=`Score: ${o}`}))}const l=Object.freeze({addPoints:function(e){e<0?o=Math.max(0,o+e):o+=e,u()},reset:function(){o=0,u()}}),m={SPAWN_POINTS:{FIRST_LANE:{x:0,y:50},SECOND_LANE:{x:0,y:165},THIRD_LANE:{x:0,y:280}},POINTS:{CORRECT_ANSWER:10,WRONG_ANSWER:-2,CASTLE_LIFE_LOST:-10},enemySpeed:40,enemySpeedIncrement:3,spawnTimerMs:2500,gameTimerMs:3e5,questionDifficulty:"medium",castleStartingLives:3};function d(e){e.style.display="none"}function h(e,t){e.style.display=t}const f={MENU:0,RUNNING:1,GAMEOVER:2,PAUSED:3},S=document.querySelector("#start-page"),y=document.querySelector("#game-page"),g=document.querySelector("#game-over-page"),E=document.querySelector(".answer-form"),p=document.querySelector("#answer-input"),N=document.querySelector("#game-timer"),T=document.querySelector("#game-over-wrong-answers"),x={},v=e.width-t.width;let A={...m},w=f.MENU,I=null,R=0,O=[];function q(){const t=function({position:{x:e,y:t},speed:n,question:i,fieldWidth:a,handleSelectEnemy:s,damageCastle:r,deleteEnemy:c}={}){const o={x:e,y:t},u=function(){const e=document.createElement("div"),t=document.createElement("div");return e.classList.add("enemy"),e.style.width="50px",e.style.height="50px",t.classList.add("enemy-question"),t.textContent=i.text,e.appendChild(t),e.addEventListener("click",s),e}();function l(){c(u),u.remove()}return Object.freeze({update:function(e){if(o.x>=a-50)return l(),void r(1);o.x+=n*(e/1e3)},draw:function(){u.style.transform=`translate(${o.x}px, ${o.y}px)`},handleDelete:l,toggleSelect:function(){u.classList.toggle("selected")},question:i,get element(){return u}})}({position:L(),speed:A.enemySpeed,question:r(A.questionDifficulty),fieldWidth:v,handleSelectEnemy:C,damageCastle:b,deleteEnemy:M});A.enemySpeed+=A.enemySpeedIncrement,e.element.appendChild(t.element),O.push(t)}function L(){const e=Object.keys(A.SPAWN_POINTS);return A.SPAWN_POINTS[e[Math.floor(Math.random()*e.length)]]}function M(e){O=O.filter((t=>t.element!==e||(I===t&&(I=null),!1)))}function P(e){if(e.preventDefault(),!I||""===p.value.trim())return;const t=I.question.answer.toString();p.value===t?(I.handleDelete(),I=null,l.addPoints(A.POINTS.CORRECT_ANSWER)):(l.addPoints(A.POINTS.WRONG_ANSWER),R+=1),p.value=""}function C(e){p.focus();const t=O.find((t=>t.element===e.currentTarget));t!==I&&(I&&I.toggleSelect(),t.toggleSelect(),I=t)}function b(e){l.addPoints(A.POINTS.CASTLE_LIFE_LOST),t.damage(e,D)}function D(){w=f.GAMEOVER,T.textContent=`Wrong Answers: ${R}`,d(y),h(g,"flex")}function _(){A={...m},x.spawnTimer=n(A.spawnTimerMs,q),x.gameTimer=n(A.gameTimerMs,D,{autoRestart:!1}),l.reset(),R=0,p.value="",t.setup(A.castleStartingLives),O.forEach((e=>e.handleDelete()))}const G=Object.freeze({GAMESTATES:f,get gameState(){return w},start:function(){_(),E.addEventListener("submit",P),d(S),h(y,"flex"),w=f.RUNNING},restart:function(){_(),d(g),h(y,"flex"),w=f.RUNNING},pause:function(){w=f.PAUSED,O.forEach((e=>e.element.classList.add("not-clickable")))},unPause:function(){w=f.RUNNING,O.forEach((e=>e.element.classList.remove("not-clickable")))},update:function(e){w===f.RUNNING&&(Object.keys(x).forEach((t=>x[t].tick(e))),O.forEach((t=>t.update(e))))},draw:function(){N.textContent=x.gameTimer.getHumanTimeRemaining(),O.forEach((e=>e.draw()))}}),W=new class{constructor(e,t){this.running=!1,this.rafID=void 0,this.update=e,this.draw=t,this.accumulatedTime=0,this.currentTime=0,this.timeStep=1e3/60,this.cycle=this.cycle.bind(this)}cycle(e){this.rafID=requestAnimationFrame(this.cycle),this.accumulatedTime+=e-this.currentTime,this.currentTime=e;let t=!1;for(this.accumulatedTime>60&&(this.accumulatedTime=this.timeStep);this.accumulatedTime>=this.timeStep;)this.update(this.timeStep),t=!0,this.accumulatedTime-=this.timeStep;t&&this.draw()}start(){this.running=!0,this.rafID=requestAnimationFrame(this.cycle)}stop(){this.running=!1,cancelAnimationFrame(this.rafID)}}(G.update,G.draw),U=document.querySelector(".start-button"),$=document.querySelector(".restart-button"),k=document.querySelector(".pause-button");U.addEventListener("click",(function(){W.start(),G.start()})),$.addEventListener("click",G.restart),k.addEventListener("click",(function(){const[e,t]=["Continue","Pause"];G.gameState===G.GAMESTATES.RUNNING?(G.pause(),W.stop(),k.textContent=e):G.gameState===G.GAMESTATES.PAUSED&&(W.start(),G.unPause(),k.textContent=t)}))})();
//# sourceMappingURL=main.bundle.js.map