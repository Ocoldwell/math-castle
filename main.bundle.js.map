{"version":3,"sources":["webpack://castle-game/./src/modules/gameBoard.js","webpack://castle-game/./src/modules/castle.js","webpack://castle-game/./src/modules/questionGenerator.js","webpack://castle-game/./src/modules/game.js","webpack://castle-game/./src/index.js","webpack://castle-game/./src/modules/timer.js","webpack://castle-game/./src/modules/enemy.js","webpack://castle-game/./src/modules/engine.js"],"names":["element","document","querySelector","height","width","lives","elements","container","getElementById","livesText","game","undefined","setup","this","draw","damage","amount","gameOver","textContent","Math","max","operatorDifficulty","easy","medium","hard","insane","wholeNumberGenerator","number","floor","random","questionNumberGenerator","difficulty","generateDifficulty","operator","length","indexOperatorGenerator","operatorSelector","questionText","text","answer","question","questionArr","split","num1","Number","num2","answerQuestion","POSITION","firstLane","secondLane","thirdLane","constructor","gameBoard","castle","answerForm","answerInput","fieldWidth","enemies","gameState","update","bind","spawnEnemy","handleAnswerSubmit","spawnTimer","duration","onFinish","elapsed","tick","deltaTime","reset","start","addEventListener","forEach","enemy","xPos","yPos","createElement","pos","x","y","speed","selected","classList","add","style","appendChild","unSelect","select","focus","selectedEnemy","find","remove","hasHitCastle","delete","transform","deleteEnemy","randomLane","push","keys","Object","enemyToDelete","filter","event","preventDefault","correctAnswer","toString","value","render","running","rafID","accumulatedTime","currentTime","timeStep","cycle","timeStamp","requestAnimationFrame","updated","stop","cancelAnimationFrame"],"mappings":"mBAAA,MAMA,EANkB,CACdA,QAASC,SAASC,cAAc,eAChCC,OAAQ,IACRC,MAAO,KCwBX,EA3Be,CACXD,OAAQ,IACRC,MAAO,IACPC,MAAO,EACPC,SAAU,CACNC,UAAWN,SAASO,eAAe,UACnCC,UAAWR,SAASO,eAAe,iBAEvCE,UAAMC,EAENC,MAAMF,GACFG,KAAKH,KAAOA,EACZG,KAAKC,QAGTC,OAAOC,GACHH,KAAKR,OAASW,EACdH,KAAKC,OAEc,IAAfD,KAAKR,OAAaQ,KAAKH,KAAKO,YAGpCH,OACID,KAAKP,SAASG,UAAUS,YAAcC,KAAKC,IAAI,EAAGP,KAAKR,SCvBzDgB,EAAqB,CACvBC,KAAM,CAAC,IAAK,KACZC,OAAQ,CAAC,IAAK,IAAK,KACnBC,KAAM,CAAC,IAAK,IAAK,KACjBC,OAAQ,CAAC,IAAK,IAAK,IAAK,MAGtBC,EAAwBC,GAAWR,KAAKS,MAAMT,KAAKU,SAAWF,GAsB9DG,EAA2BC,GAC7BL,EArBuB,CAACK,IACxB,OAAQA,GACJ,IAAK,OACD,OAAO,EACX,IAAK,SACD,OAAO,GACX,IAAK,OACD,OAAO,GACX,IAAK,SACD,OAAO,IACX,QACI,OAAO,IAUMC,CAAmBD,IAAe,EAiC3D,EAb2BA,IACvB,MAAME,EAzBe,CAACF,GACtBV,EAAmBU,GAJQ,CAACA,GAC5BL,EAAqBL,EAAmBU,GAAYG,QAGrBC,CAAuBJ,IAwBrCK,CAAiBL,GAC5BM,EAAe,GAAGP,EACpBC,MACCE,KAAYH,EAAwBC,KAGzC,MAAO,CACHO,KAAMD,EACNE,OA3Be,CAACC,IACpB,MAAMC,EAAcD,EAASE,MAAM,KAC7BC,EAAOC,OAAOH,EAAY,IAC1BR,EAAWQ,EAAY,GACvBI,EAAOD,OAAOH,EAAY,IAChC,IAAIF,EAUJ,OARIA,EADa,MAAbN,EACSU,EAAOE,EACI,MAAbZ,EACEU,EAAOE,EACI,MAAbZ,EACEU,EAAOE,EAEPF,EAAOE,EAEbN,GAQQO,CAAeT,KC3C5BU,EAAW,CACbC,UAAW,GACXC,WAAY,IACZC,UAAW,KCXT,EAAO,IDcb,MACIC,cACItC,KAAKuC,UAAY,EACjBvC,KAAKwC,OAAS,EACdxC,KAAKyC,WAAarD,SAASC,cAAc,gBACzCW,KAAK0C,YAActD,SAASC,cAAc,iBAE1CW,KAAK2C,WAAa,QAAkB,QACpC3C,KAAK4C,QAAU,GACf5C,KAAK6C,UApBH,EAuBF7C,KAAK8C,OAAS9C,KAAK8C,OAAOC,KAAK/C,MAC/BA,KAAKC,KAAOD,KAAKC,KAAK8C,KAAK/C,MAC3BA,KAAKgD,WAAahD,KAAKgD,WAAWD,KAAK/C,MACvCA,KAAKiD,mBAAqBjD,KAAKiD,mBAAmBF,KAAK/C,MAEvDA,KAAKkD,WAAa,IEnC1B,MACIZ,YAAYa,EAAUC,GAClBpD,KAAKmD,SAAWA,EAChBnD,KAAKoD,SAAWA,EAChBpD,KAAKqD,QAAU,EAGnBC,KAAKC,GACDvD,KAAKqD,SAAWE,EAEZvD,KAAKqD,QAAUrD,KAAKmD,WACpBnD,KAAKoD,WACLpD,KAAKwD,SAIbA,QACIxD,KAAKqD,QAAU,IFkBa,IAAMrD,KAAKgD,YAG3CS,QACIzD,KAAKwC,OAAOzC,MAAMC,MAClBA,KAAKyC,WAAWiB,iBAAiB,SAAU1D,KAAKiD,oBAChDjD,KAAK6C,UAjCA,EAoCTC,OAAOS,GApCE,IAqCDvD,KAAK6C,YAET7C,KAAKkD,WAAWI,KAAKC,GACrBvD,KAAK4C,QAAQe,SAASC,GAAUA,EAAMd,OAAO9C,KAAMuD,MAGvDtD,OACID,KAAK4C,QAAQe,SAASC,GAAUA,EAAM3D,SAG1C+C,aACI,MAAMY,EAAQ,IGxDtB,MACItB,YAAYuB,EAAMC,EAAMjE,EAAM8B,GAC1B3B,KAAKP,SAAW,CACZmE,MAAOxE,SAAS2E,cAAc,OAC9BpC,SAAUvC,SAAS2E,cAAc,QAGrC/D,KAAKgE,IAAM,CAAEC,EAAGJ,EAAMK,EAAGJ,GACzB9D,KAAKT,MAAQ,GACbS,KAAKV,OAAS,GACdU,KAAKmE,MAAQ,GACbnE,KAAKoE,UAAW,EAChBpE,KAAK2B,SAAWA,EAChB3B,KAAKH,KAAOA,EAGZG,KAAKP,SAASmE,MAAMS,UAAUC,IAAI,SAClCtE,KAAKP,SAASmE,MAAMW,MAAMhF,MAAQ,GAAGS,KAAKT,UAC1CS,KAAKP,SAASmE,MAAMW,MAAMjF,OAAS,GAAGU,KAAKV,WAG3CU,KAAKP,SAASkC,SAAS0C,UAAUC,IAAI,kBACrCtE,KAAKP,SAASkC,SAAStB,YAAcL,KAAK2B,SAASF,KACnDzB,KAAKP,SAASmE,MAAMY,YAAYxE,KAAKP,SAASkC,UAG9C3B,KAAKP,SAASmE,MAAMF,iBAAiB,SAAS,KAC1C1D,KAAKyE,WACLzE,KAAK0E,SACL1E,KAAKH,KAAK6C,YAAYiC,WAI9BD,SAEI1E,KAAKoE,UAAW,EACZpE,KAAKoE,UACLpE,KAAKP,SAASmE,MAAMS,UAAUC,IAAI,YAI1CG,WAEI,MACMG,EADa5E,KAAKH,KAAK+C,QACIiC,MAAMjB,GAAUA,EAAMQ,gBACjCtE,IAAlB8E,IACJA,EAAcR,UAAW,EACzBQ,EAAcnF,SAASmE,MAAMS,UAAUS,OAAO,aAGlDhC,OAAOjD,EAAM0D,GACT,GAAIvD,KAAK+E,aAAalF,GAGlB,OAFAG,KAAKgF,OAAOnF,QACZA,EAAK2C,OAAOtC,OAAO,GAMvBF,KAAKgE,IAAIC,GAAKjE,KAAKmE,OAASZ,EAAY,KAG5CtD,OAEID,KAAKP,SAASmE,MAAMW,MAAMU,UAAY,aAAajF,KAAKgE,IAAIC,QAAQjE,KAAKgE,IAAIE,OAGjFc,OAAOnF,GAEHG,KAAKP,SAASmE,MAAMkB,SAEpBjF,EAAKqF,YAAYlF,MAGrB+E,aAAalF,GACT,OAAOG,KAAKgE,IAAIC,GAAKpE,EAAK8C,WAAa3C,KAAKT,QHlBxC,EACAS,KAAKmF,aACLnF,KACA,EAAkB,WAEtBA,KAAKuC,UAAUpD,QAAQqF,YAAYZ,EAAMnE,SAASmE,OAClD5D,KAAK4C,QAAQwC,KAAKxB,GAItBuB,aAEI,MAAME,EAAOC,OAAOD,KAAKnD,GACzB,OAAOA,EAASmD,EAAK/E,KAAKS,MAAMT,KAAKU,SAAWqE,EAAKhE,UAGzD6D,YAAYK,GACRvF,KAAK4C,QAAU5C,KAAK4C,QAAQ4C,QAAQ5B,GAAUA,IAAU2B,IAG5DnF,WACIJ,KAAK6C,UArEC,EAwEVI,mBAAmBwC,GACfA,EAAMC,iBAEN,MAAMd,EAAgB5E,KAAK4C,QAAQiC,MAAMjB,GAAUA,EAAMQ,WACzD,IAAKQ,EAAe,OAEpB,MAAMe,EAAgBf,EAAcjD,SAASD,OAAOkE,WACjC5F,KAAK0C,YAAYmD,QAEjBF,GAAef,EAAcI,OAAOhF,MAEvDA,KAAK0C,YAAYmD,MAAQ,KCvFlB,IGLf,MACIvD,YAAYQ,EAAQgD,GAChB9F,KAAK+F,SAAU,EACf/F,KAAKgG,WAAQlG,EAEbE,KAAK8C,OAASA,EACd9C,KAAKC,KAAO6F,EAEZ9F,KAAKiG,gBAAkB,EACvBjG,KAAKkG,YAAc,EACnBlG,KAAKmG,SAAW,IAAO,GAEvBnG,KAAKoG,MAAQpG,KAAKoG,MAAMrD,KAAK/C,MAGjCoG,MAAMC,GACFrG,KAAKgG,MAAQM,sBAAsBtG,KAAKoG,OAExCpG,KAAKiG,iBAAmBI,EAAYrG,KAAKkG,YACzClG,KAAKkG,YAAcG,EAEnB,IAAIE,GAAU,EAMd,IAJIvG,KAAKiG,gBAAkB,KACvBjG,KAAKiG,gBAAkBjG,KAAKmG,UAGzBnG,KAAKiG,iBAAmBjG,KAAKmG,UAChCnG,KAAK8C,OAAO9C,KAAKmG,UAEjBI,GAAU,EAEVvG,KAAKiG,iBAAmBjG,KAAKmG,SAG7BI,GAASvG,KAAKC,OAGtBwD,QACIzD,KAAK+F,SAAU,EACf/F,KAAKgG,MAAQM,sBAAsBtG,KAAKoG,OAG5CI,OACIxG,KAAK+F,SAAU,EACfU,qBAAqBzG,KAAKgG,SHxCR,EAAKlD,OAAQ,EAAK7C,MAErCwD,QACP,EAAKA,S","file":"main.bundle.js","sourcesContent":["const gameBoard = {\n    element: document.querySelector('#game-board'),\n    height: 400,\n    width: 900,\n};\n\nexport default gameBoard;\n","const castle = {\n    height: 400,\n    width: 200,\n    lives: 3,\n    elements: {\n        container: document.getElementById('castle'),\n        livesText: document.getElementById('castle-lives'),\n    },\n    game: undefined,\n\n    setup(game) {\n        this.game = game;\n        this.draw();\n    },\n\n    damage(amount) {\n        this.lives -= amount;\n        this.draw();\n\n        if (this.lives === 0) this.game.gameOver();\n    },\n\n    draw() {\n        this.elements.livesText.textContent = Math.max(0, this.lives);\n    },\n};\n\nexport default castle;\n","const operatorDifficulty = {\n    easy: ['+', '-'],\n    medium: ['+', '-', '*'],\n    hard: ['+', '-', '*'],\n    insane: ['+', '-', '*', '/'],\n};\n\nconst wholeNumberGenerator = (number) => Math.floor(Math.random() * number);\n\nconst generateDifficulty = (difficulty) => {\n    switch (difficulty) {\n        case 'easy':\n            return 5;\n        case 'medium':\n            return 10;\n        case 'hard':\n            return 30;\n        case 'insane':\n            return 100;\n        default:\n            return 5;\n    }\n};\nconst indexOperatorGenerator = (difficulty) =>\n    wholeNumberGenerator(operatorDifficulty[difficulty].length);\n\nconst operatorSelector = (difficulty) =>\n    operatorDifficulty[difficulty][indexOperatorGenerator(difficulty)];\n\nconst questionNumberGenerator = (difficulty) =>\n    wholeNumberGenerator(generateDifficulty(difficulty)) + 1;\n\nconst answerQuestion = (question) => {\n    const questionArr = question.split(' ');\n    const num1 = Number(questionArr[0]);\n    const operator = questionArr[1];\n    const num2 = Number(questionArr[2]);\n    let answer;\n    if (operator === '+') {\n        answer = num1 + num2;\n    } else if (operator === '-') {\n        answer = num1 - num2;\n    } else if (operator === '*') {\n        answer = num1 * num2;\n    } else {\n        answer = num1 / num2;\n    }\n    return answer;\n};\n\nconst questionGenerator = (difficulty) => {\n    const operator = operatorSelector(difficulty);\n    const questionText = `${questionNumberGenerator(\n        difficulty\n    )} ${operator} ${questionNumberGenerator(difficulty)}`;\n    const answer = answerQuestion(questionText);\n\n    return {\n        text: questionText,\n        answer,\n    };\n};\n\nexport default questionGenerator;\n","import gameBoard from './gameBoard';\nimport castle from './castle';\nimport Enemy from './enemy';\nimport Timer from './timer';\nimport questionGenerator from './questionGenerator';\n\nconst GAMESTATE = {\n    MENU: 0,\n    RUNNING: 1,\n    GAMEOVER: 2,\n};\n\nconst POSITION = {\n    firstLane: 50,\n    secondLane: 165,\n    thirdLane: 280,\n};\n\nclass Game {\n    constructor() {\n        this.gameBoard = gameBoard;\n        this.castle = castle;\n        this.answerForm = document.querySelector('.answer-form');\n        this.answerInput = document.querySelector('#answer-input');\n        // width of area enemy can move in\n        this.fieldWidth = gameBoard.width - castle.width;\n        this.enemies = [];\n        this.gameState = GAMESTATE.MENU;\n\n        // bind methods 'this' to Game class\n        this.update = this.update.bind(this);\n        this.draw = this.draw.bind(this);\n        this.spawnEnemy = this.spawnEnemy.bind(this);\n        this.handleAnswerSubmit = this.handleAnswerSubmit.bind(this);\n\n        this.spawnTimer = new Timer(2000, this.spawnEnemy);\n    }\n\n    start() {\n        this.castle.setup(this);\n        this.answerForm.addEventListener('submit', this.handleAnswerSubmit);\n        this.gameState = GAMESTATE.RUNNING;\n    }\n\n    update(deltaTime) {\n        if (this.gameState !== GAMESTATE.RUNNING) return;\n\n        this.spawnTimer.tick(deltaTime);\n        this.enemies.forEach((enemy) => enemy.update(this, deltaTime));\n    }\n\n    draw() {\n        this.enemies.forEach((enemy) => enemy.draw());\n    }\n\n    spawnEnemy() {\n        const enemy = new Enemy(\n            0,\n            this.randomLane(),\n            this,\n            questionGenerator('insane')\n        );\n        this.gameBoard.element.appendChild(enemy.elements.enemy);\n        this.enemies.push(enemy);\n    }\n\n    // eslint-disable-next-line class-methods-use-this\n    randomLane() {\n        // randomly choose an object keys in the POSITION object\n        const keys = Object.keys(POSITION);\n        return POSITION[keys[Math.floor(Math.random() * keys.length)]];\n    }\n\n    deleteEnemy(enemyToDelete) {\n        this.enemies = this.enemies.filter((enemy) => enemy !== enemyToDelete);\n    }\n\n    gameOver() {\n        this.gameState = GAMESTATE.GAMEOVER;\n    }\n\n    handleAnswerSubmit(event) {\n        event.preventDefault();\n\n        const selectedEnemy = this.enemies.find((enemy) => enemy.selected);\n        if (!selectedEnemy) return;\n\n        const correctAnswer = selectedEnemy.question.answer.toString();\n        const userAnswer = this.answerInput.value;\n\n        if (userAnswer === correctAnswer) selectedEnemy.delete(this);\n\n        this.answerInput.value = '';\n    }\n}\n\nexport default Game;\n","import './styles/styles.css';\nimport Game from './modules/game';\nimport Engine from './modules/engine';\n\nconst game = new Game();\nconst engine = new Engine(game.update, game.draw);\n\nengine.start();\ngame.start();\n","class Timer {\n    constructor(duration, onFinish) {\n        this.duration = duration;\n        this.onFinish = onFinish;\n        this.elapsed = 0;\n    }\n\n    tick(deltaTime) {\n        this.elapsed += deltaTime;\n\n        if (this.elapsed > this.duration) {\n            this.onFinish();\n            this.reset();\n        }\n    }\n\n    reset() {\n        this.elapsed = 0;\n    }\n}\n\nexport default Timer;\n","class Enemy {\n    constructor(xPos, yPos, game, question) {\n        this.elements = {\n            enemy: document.createElement('div'),\n            question: document.createElement('div'),\n        };\n\n        this.pos = { x: xPos, y: yPos };\n        this.width = 50;\n        this.height = 50;\n        this.speed = 60; // px per second\n        this.selected = false; // default false (not selected)\n        this.question = question;\n        this.game = game;\n\n        // setting some enemy css\n        this.elements.enemy.classList.add('enemy');\n        this.elements.enemy.style.width = `${this.width}px`;\n        this.elements.enemy.style.height = `${this.height}px`;\n\n        // question element styles\n        this.elements.question.classList.add('enemy-question');\n        this.elements.question.textContent = this.question.text;\n        this.elements.enemy.appendChild(this.elements.question);\n\n        // set enemy selected\n        this.elements.enemy.addEventListener('click', () => {\n            this.unSelect();\n            this.select();\n            this.game.answerInput.focus();\n        });\n    }\n\n    select() {\n        // select clicked enemy\n        this.selected = true;\n        if (this.selected) {\n            this.elements.enemy.classList.add('selected');\n        }\n    }\n\n    unSelect() {\n        // remove all selected class and attribute in order to make only one selection\n        const enemiesArr = this.game.enemies;\n        const selectedEnemy = enemiesArr.find((enemy) => enemy.selected);\n        if (selectedEnemy === undefined) return;\n        selectedEnemy.selected = false;\n        selectedEnemy.elements.enemy.classList.remove('selected');\n    }\n\n    update(game, deltaTime) {\n        if (this.hasHitCastle(game)) {\n            this.delete(game);\n            game.castle.damage(1);\n            return;\n        }\n\n        // multiply speed by deltaTime in seconds for consistent movement across\n        // different framerates\n        this.pos.x += this.speed * (deltaTime / 1000);\n    }\n\n    draw() {\n        // draw the enemy to different position\n        this.elements.enemy.style.transform = `translate(${this.pos.x}px, ${this.pos.y}px)`;\n    }\n\n    delete(game) {\n        // remove enemy from game-board\n        this.elements.enemy.remove();\n        // remove enemy from enemies array\n        game.deleteEnemy(this);\n    }\n\n    hasHitCastle(game) {\n        return this.pos.x >= game.fieldWidth - this.width;\n    }\n}\n\nexport default Enemy;\n","class Engine {\n    constructor(update, render) {\n        this.running = false;\n        this.rafID = undefined;\n\n        this.update = update;\n        this.draw = render;\n\n        this.accumulatedTime = 0;\n        this.currentTime = 0;\n        this.timeStep = 1000 / 60;\n\n        this.cycle = this.cycle.bind(this);\n    }\n\n    cycle(timeStamp) {\n        this.rafID = requestAnimationFrame(this.cycle);\n\n        this.accumulatedTime += timeStamp - this.currentTime;\n        this.currentTime = timeStamp;\n\n        let updated = false;\n\n        if (this.accumulatedTime > 60) {\n            this.accumulatedTime = this.timeStep;\n        }\n\n        while (this.accumulatedTime >= this.timeStep) {\n            this.update(this.timeStep);\n\n            updated = true;\n\n            this.accumulatedTime -= this.timeStep;\n        }\n\n        if (updated) this.draw();\n    }\n\n    start() {\n        this.running = true;\n        this.rafID = requestAnimationFrame(this.cycle);\n    }\n\n    stop() {\n        this.running = false;\n        cancelAnimationFrame(this.rafID);\n    }\n}\n\nexport default Engine;\n"],"sourceRoot":""}